# æœ€ç»ˆéƒ¨ç½²æŒ‡å— - è§£å†³Railwayç¼“å­˜é—®é¢˜

## ğŸ” é—®é¢˜è¯Šæ–­

Railwayæ²¡æœ‰ä½¿ç”¨æœ€æ–°çš„éƒ¨ç½²è„šæœ¬ï¼Œè¿˜åœ¨è¿è¡Œæ—§çš„è„šæœ¬æ­¥éª¤ã€‚è¿™æ˜¯å› ä¸ºï¼š

1. **Railwayç¼“å­˜é—®é¢˜** - é…ç½®æ›´æ”¹æ²¡æœ‰è¢«æ­£ç¡®è¯†åˆ«
2. **è„šæœ¬å¼•ç”¨é—®é¢˜** - æ—§è„šæœ¬ä¸­å¼•ç”¨äº†å·²åˆ é™¤çš„æ–‡ä»¶
3. **éƒ¨ç½²é…ç½®é—®é¢˜** - Railwayå¯èƒ½è¿˜åœ¨ä½¿ç”¨ç¼“å­˜çš„é…ç½®

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. æ¸…ç†æ—§æ–‡ä»¶
- âœ… åˆ é™¤äº† `backend/deploy.sh`ï¼ˆåŒ…å«å¯¹ä¸å­˜åœ¨æ–‡ä»¶çš„å¼•ç”¨ï¼‰
- âœ… åˆ é™¤äº† `backend/fix-paths.js`ï¼ˆä¸´æ—¶æ–‡ä»¶ï¼‰
- âœ… åˆ é™¤äº† `backend/update-prisma-imports.js`ï¼ˆä¸´æ—¶æ–‡ä»¶ï¼‰

### 2. åˆ›å»ºæ–°è„šæœ¬
- âœ… åˆ›å»ºäº† `backend/clean-deploy.sh` æœ€å¹²å‡€çš„éƒ¨ç½²è„šæœ¬
- âœ… ç§»é™¤äº†æ‰€æœ‰å¯¹ä¸å­˜åœ¨æ–‡ä»¶çš„å¼•ç”¨
- âœ… æ·»åŠ äº†é”™è¯¯å¤„ç†ï¼Œç§å­å¤±è´¥ä¸ä¼šé˜»æ­¢éƒ¨ç½²

### 3. æ›´æ–°é…ç½®
- âœ… æ›´æ–°äº† `railway.json` ä½¿ç”¨æ–°çš„éƒ¨ç½²è„šæœ¬
- âœ… ç¡®ä¿æ‰€æœ‰è„šæœ¬æœ‰æ­£ç¡®çš„æ‰§è¡Œæƒé™

## ğŸš€ ç«‹å³è§£å†³æ­¥éª¤

### æ­¥éª¤1ï¼šæ¨é€æ‰€æœ‰æ›´æ”¹
```bash
git add .
git commit -m "Force redeploy: Use clean-deploy.sh and remove old scripts"
git push origin main
```

### æ­¥éª¤2ï¼šåœ¨Railway Dashboardä¸­å¼ºåˆ¶é‡æ–°éƒ¨ç½²
1. è¿›å…¥Railway Dashboard
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. ç‚¹å‡» "Deploy" æŒ‰é’®
4. é€‰æ‹© "Deploy Now" å¼ºåˆ¶é‡æ–°éƒ¨ç½²

### æ­¥éª¤3ï¼šéªŒè¯éƒ¨ç½²
æ–°çš„éƒ¨ç½²æµç¨‹åº”è¯¥æ˜¯ï¼š
```
ğŸš€ Starting USDE Backend Deployment...
ğŸ“¦ Installing dependencies...
ğŸ”§ Generating Prisma client...
ğŸ—„ï¸ Pushing database schema...
ğŸŒ± Seeding database...
âœ… Deployment completed!
ğŸš€ Starting server...
```

## ğŸ”§ å¦‚æœé—®é¢˜æŒç»­

### æ–¹æ¡ˆ1ï¼šæ£€æŸ¥Railwayé…ç½®
ç¡®ä¿ `railway.json` å†…å®¹ä¸ºï¼š
```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "cd backend && ./clean-deploy.sh",
    "healthcheckPath": "/api/health",
    "healthcheckTimeout": 300,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

### æ–¹æ¡ˆ2ï¼šæ‰‹åŠ¨è§¦å‘éƒ¨ç½²
å¦‚æœè‡ªåŠ¨éƒ¨ç½²ä¸å·¥ä½œï¼š
1. åœ¨Railway Dashboardä¸­åˆ é™¤å½“å‰éƒ¨ç½²
2. é‡æ–°è¿æ¥GitHubä»“åº“
3. æ‰‹åŠ¨è§¦å‘æ–°çš„éƒ¨ç½²

### æ–¹æ¡ˆ3ï¼šæ£€æŸ¥æ–‡ä»¶æƒé™
ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼š
```bash
chmod +x backend/clean-deploy.sh
```

## ğŸ“Š éªŒè¯æˆåŠŸ

éƒ¨ç½²æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
- âœ… æ²¡æœ‰ "Cannot find module" é”™è¯¯
- âœ… æ•°æ®åº“schemaæ¨é€æˆåŠŸ
- âœ… æœåŠ¡å™¨æ­£å¸¸å¯åŠ¨
- âœ… å¥åº·ç«¯ç‚¹å¯è®¿é—®ï¼š`https://usde-usde.up.railway.app/api/health`

## ğŸ†˜ ç´§æ€¥ä¿®å¤

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼š

### æ–¹æ¡ˆAï¼šé‡æ–°åˆ›å»ºé¡¹ç›®
1. åœ¨Railway Dashboardä¸­åˆ é™¤é¡¹ç›®
2. é‡æ–°åˆ›å»ºé¡¹ç›®å¹¶è¿æ¥GitHub
3. é‡æ–°è®¾ç½®ç¯å¢ƒå˜é‡
4. è§¦å‘æ–°çš„éƒ¨ç½²

### æ–¹æ¡ˆBï¼šä½¿ç”¨å†…è”å‘½ä»¤
å¦‚æœè„šæœ¬ä»ç„¶æœ‰é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥åœ¨Railwayé…ç½®ä¸­ä½¿ç”¨å†…è”å‘½ä»¤ï¼š
```json
{
  "deploy": {
    "startCommand": "cd backend && npm install && npx prisma generate && npx prisma db push && node prisma/seed-users.js || echo 'Seeding failed' && npm start"
  }
}
```

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

éƒ¨ç½²æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
- âœ… å¥åº·ç«¯ç‚¹è¿”å›200çŠ¶æ€
- âœ… æœåŠ¡å™¨åœ¨ç«¯å£8080è¿è¡Œ
- âœ… æ•°æ®åº“è¡¨å·²åˆ›å»º
- âœ… ç§å­æ•°æ®å·²åŠ è½½ï¼ˆå¯é€‰ï¼‰

## ğŸ“ æ”¯æŒ

å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼š
1. æ£€æŸ¥Railwayéƒ¨ç½²æ—¥å¿—
2. éªŒè¯ç¯å¢ƒå˜é‡è®¾ç½®
3. ç¡®è®¤æ•°æ®åº“æœåŠ¡çŠ¶æ€
4. æŸ¥çœ‹åº”ç”¨å¥åº·çŠ¶æ€ 